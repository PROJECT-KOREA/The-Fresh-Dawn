### 뉴스 이벤트 ###
add_namespace = pk_sjw

# 중국연합전선 창설
country_event = {
	id = pk_sjw.1
	title = pk_sjw.1.t
	desc = pk_sjw.1.d
	picture = pk_sjw
	is_triggered_only = yes
	# trigger = {
	# 	NOT = {  #this is to separate "emergency truce" scenario and regular united front scenario
	# 		AND = {
	# 			is_subject = no
	# 			NOT = { is_ally_with = JAP }
	# 			any_enemy_country = {
	# 				is_subject = no
	# 				NOT = { #prevent zhang lan
	# 					tag = event_target:CDL_JAP_puppet
	# 				}
	# 				NOT = { is_ally_with = JAP }
	# 				NOT = {
	# 					original_tag = PREV
	# 				}
	# 				NOT = {
	# 					is_ally_with = ROOT
	# 				}
	# 				is_literally_china = yes
	# 				NOT = {
	# 					tag = MAN
	# 					tag = ECA
	# 					tag = EHB
	# 					tag = RFM
	# 					tag = CCP
	# 				}
	# 			}
	# 		}
	# 	}
	# }
	option = {
		name = pk_sjw.1.a
		if = {
			limit = { NOT = { is_in_faction = yes } }
			create_faction = chinese_united_front # 중국연합전선 창설
		}
		# if = {
		# 	limit = {
		# 		HPC = { exists = yes }
		# 		NOT = { HPC = { is_subject_of = JAP } }
		# 	}
		# 	add_to_faction = HPC
		# 	add_to_war = { targeted_alliance = HPC enemy = JAP }
		# }
		set_global_flag = JAP_attacks_CHI_unites # flag 지정
		every_other_country = {
			limit = {
				exists = yes
				AND = {
					is_warlords = yes
					NOT = { original_tag = SIK }
				}
				# NOT = {
				# 	tag = SIK # 신강 군벌 제외
				# 	is_subject_of = JAP # 일본의 종속국이 아닐 것
				# 	has_war_with = event_target:WTT_current_china_leader # 중국과 전쟁 중이지 않을 것
				# }
				# is_in_faction = no # 세력에 소속되지 않을 것
				# OR = { # 전쟁 중이 아니거나, 또는 일본과 전쟁 중일 것
				# 	has_war = no
				# 	has_war_with = JAP
				# }
				# NOT = {
				# 	tag = ROOT
				# 	AND = {
				# 		OR = {
				# 			tag = HMI
				# 			tag = TNG
				# 		}
				# 		has_war_with = SIK
				# 	}
				# }
				# OR = {
				# 	owns_state = 614
				# 	tag = SHD
				# }
			}
			country_event = {
				id = pk_sjw.2
				days = 1
			} # 연합전선 초대 발송
		}
		if = {
			limit = {
				PRC = {
					exists = yes
					is_subject = no
				}
			}
			PRC = {
				country_event = { # 연합전선 초대 발송
					id = pk_sjw.4
					days = 2
				}
			}
		}
	}
}

# 군벌 - 중국의 연합전선 초대
country_event = {
	id = pk_sjw.2
	title = pk_sjw.2.t
	desc = pk_sjw.2.d
	picture = GFX_report_event_chinese_officers
	is_triggered_only = yes

	option = { # 연합전선 참가
		name = pk_sjw.2.a
		ai_chance = {
			factor = 100
			modifier = { # 기찰정무위원회, 산동 군벌, 사천 군벌 제외
				factor = 0
				OR = {
					tag = HPC
			 		# tag = TNG
			 		# tag = SHD
			 		# tag = SIC
				}
			}
		}
		FROM = { add_to_faction = ROOT } # 중국연합전선에 가담
		add_to_war = { targeted_alliance = FROM enemy = JAP } # 중일전쟁에 가담
		hidden_effect = {
			FROM = {
				country_event = { id = pk_sjw.5 }
			}
		}
	}

	option = {
		name = pk_sjw.2.b # 기찰정무위원회 합병
		trigger = {
			is_warlords = yes
			NOT = {
				OR = {
					tag = SHX
					tag = GXC
					tag = YUN
					tag = XSM
					tag = SIK
				}
			}
		}
		ai_chance = {
			factor = 100
			# modifier = {
			# 	factor = 0
			# 	NOT = { has_government = FROM }
			# }
		}
		custom_effect_tooltip = GAME_OVER_TT
		hidden_effect = {
			ROOT_army_leaders_join_FROM = yes
			every_unit_leader = {
				set_nationality = event_target:WTT_current_china_leader
			}
			event_target:WTT_current_china_leader = {
				country_event = { id = pk_sjw.3 }
				annex_country = { target = ROOT transfer_troops = yes }
			}
			# transfer_state = 614
			# transfer_state = 608
			FROM = {
				annex_country = { target = HPC transfer_troops = yes }
				every_owned_state = { remove_core_of = HPC }
			}
		}
	}

	option =  { # 아무것도 안함
		name = pk_sjw.2.c
		trigger = {
			NOT = { tag = HPC }
			has_completed_focus = CHI_opposition
		}
		ai_chance = { factor = 0 }
		add_political_power = -30
	}
}

# FROM - 중국에 합병
country_event = {
	id = pk_sjw.3
	title = pk_sjw.3.t
	desc = pk_sjw.3.d
	picture = GFX_report_event_chinese_army_training
	is_triggered_only = yes
	option = {
		name = pk_sjw.3.a
	}
}

# 중국 공산당 - 중국의 연합전선 초대
country_event = {
	id = pk_sjw.4
	title = pk_sjw.4.t
	desc = pk_sjw.4.d
	picture = GFX_report_event_chinese_army_training
	fire_only_once = yes
	is_triggered_only = yes
	# trigger = { }
	
	option = {
		ai_chance = { factor = 100 }
		name = pk_sjw.4.a
		set_country_flag = PRC_joined_CHI_against_JAP
		random_other_country = {
			limit = { is_legit_china = yes }
			country_event = { id = pk_sjw.5 }
			add_to_faction = ROOT
			PRC = { add_opinion_modifier = { target = PREV modifier = unstable_alliance } }
			add_opinion_modifier = { target = PRC modifier = unstable_alliance }
			add_to_war = {
				targeted_alliance = PREV
				enemy = JAP
			}
		}

		# if = {
		# 	limit = { NOT = { has_war_with = SOV } }
		# 	custom_effect_tooltip = pk_sjw.104_PRC_SOV_reinforcements
		# }
		# custom_effect_tooltip = chinese_sov_rep_dissolves

		hidden_effect = { set_cosmetic_tag = PRC_SGN }
	}

	#Nothing
	option = {
		ai_chance = { factor = 0 }
		name = pk_sjw.4.b
	}
}

# 중국 - 군벌 참전 알림
country_event = {
	id = pk_sjw.5
	title = pk_sjw.5.t
	desc = pk_sjw.5.d
	picture = GFX_report_event_chinese_army_training
	is_triggered_only = yes
	immediate = {
		hidden_effect = {
			if = {
				limit = { FROM = { tag = PRC } }
				FROM = {
					add_to_war = {
						targeted_alliance = ROOT
						enemy = JAP
					}
				}
			}
		}
	}
	option = {
		name = pk_sjw.5.a
	}
}